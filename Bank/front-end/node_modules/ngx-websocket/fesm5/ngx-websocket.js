import { Injectable, Component, NgModule, defineInjectable } from '@angular/core';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var Subscribe = /** @class */ (function () {
    function Subscribe(_type, _f) {
        this.type = _type;
        this.f = _f;
    }
    return Subscribe;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
/**
 * Socket class
 * each socket handles a single WebScoket Connection.
 */
var  /**
 * Socket class
 * each socket handles a single WebScoket Connection.
 */
Socket = /** @class */ (function () {
    function Socket(url) {
        var _this = this;
        this.url = url;
        try {
            this.websocket = new WebSocket(url);
        }
        catch (/** @type {?} */ e) {
            console.error(e);
        }
        this._state = "closed";
        this._subscribes = [];
        //onOpen
        this.websocket.addEventListener("open", function (e) {
            //websocket stream start
            //websocket stream start
            _this.subscribeLoop(true);
        });
        //onError
        this.websocket.addEventListener("error", function (e) {
            console.error("websocket onError");
        });
        //onMessage
        // this._messageObservable = Observable.create((observer) => {
        //     this.websocket.addEventListener("message", (e) => {
        //         observer.next({
        //             event: e
        //         });
        //         //stream start again
        //         this.subscribeLoop(false);
        //     });
        // });
        //onMessage
        this.websocket.addEventListener("message", function (e) {
            _this._receiveData = e;
            //stream start again
            //stream start again
            _this.subscribeLoop(false);
        });
        //onClose
        this.websocket.addEventListener("close", function (e) {
            _this._state = "closed";
            console.warn("websocket onClose");
        });
    }
    /**
     * reveive data from previous handler, wouldn't block current stream.
     * @param {?} f
     * @return {?}
     */
    Socket.prototype.then = /**
     * reveive data from previous handler, wouldn't block current stream.
     * @param {?} f
     * @return {?}
     */
    function (f) {
        this._subscribes.push(new Subscribe(0, f));
        return this;
    };
    /**
     * callback funtion when websocket reveive message.
     * @param {?} f
     * @return {?}
     */
    Socket.prototype.message = /**
     * callback funtion when websocket reveive message.
     * @param {?} f
     * @return {?}
     */
    function (f) {
        this._subscribes.push(new Subscribe(1, f));
        return this;
    };
    /**
     * catch error or close state on websocket;
     * @return {?}
     */
    Socket.prototype.catch = /**
     * catch error or close state on websocket;
     * @return {?}
     */
    function () {
        return this;
    };
    /**
     * finally handler.
     * @return {?}
     */
    Socket.prototype.finally = /**
     * finally handler.
     * @return {?}
     */
    function () {
        return this;
    };
    /**
     * send message via this websocket
     * @param {?} message
     * @return {?}
     */
    Socket.prototype.send = /**
     * send message via this websocket
     * @param {?} message
     * @return {?}
     */
    function (message) {
        try {
            this.websocket.send(message);
        }
        catch (/** @type {?} */ e) {
            console.error(e);
        }
        return this;
    };
    /**
     * close websocket
     * @return {?}
     */
    Socket.prototype.close = /**
     * close websocket
     * @return {?}
     */
    function () {
        this.websocket.close();
    };
    /**
     * traversal subscirbes set, execute action according to item's type
     * @param {?} init if subscribeLoop is the first tiem to execute, than every 'then' handler before the first message handler will be remove after execute.
     * @return {?}
     */
    Socket.prototype.subscribeLoop = /**
     * traversal subscirbes set, execute action according to item's type
     * @param {?} init if subscribeLoop is the first tiem to execute, than every 'then' handler before the first message handler will be remove after execute.
     * @return {?}
     */
    function (init) {
        for (var /** @type {?} */ i = 0, /** @type {?} */ len = this._subscribes.length; i < len; i++) {
            var /** @type {?} */ sub = this._subscribes[i];
            if (sub.type === 0) {
                this._passingData = sub.f(this._passingData, this);
                if (init === true)
                    this._subscribes[i] = new Subscribe(0, function () { });
            }
            if (sub.type === 1) {
                if (init === true)
                    break;
                // this._messageObservable.subscribe({
                //     next(d) {
                //         socket._passingData = sub.f((d.event.data), socket._passingData, socket, d.event);
                //     },
                //     error(msg) {
                //         //call the catch handler
                //     }
                // });
                this._passingData = sub.f(this._receiveData.data, this._passingData, this, this._receiveData);
            }
        }
    };
    Object.defineProperty(Socket.prototype, "state", {
        get: /**
         * @return {?}
         */
        function () {
            return this._state;
        },
        enumerable: true,
        configurable: true
    });
    return Socket;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
/**
 * this service provides multiple methods to create websocket, add callback function to websocekt or destory webscoket.
 */
var NgxWebsocketService = /** @class */ (function () {
    function NgxWebsocketService() {
        this.sockets = new Map();
    }
    /**
     * @param {?} url
     * @return {?}
     */
    NgxWebsocketService.prototype.open = /**
     * @param {?} url
     * @return {?}
     */
    function (url) {
        if (!this.checkExistence(url)) {
            var /** @type {?} */ socket = new Socket(url);
            this.sockets.set(url, socket);
            return socket;
        }
    };
    /**
     * @param {?} url
     * @return {?}
     */
    NgxWebsocketService.prototype.checkExistence = /**
     * @param {?} url
     * @return {?}
     */
    function (url) {
        this.sockets.forEach(function (key, value) {
            if (key === url) {
                //check connection state
                console.warn("a websocket with same url has existed");
                return true;
            }
        });
        return false;
    };
    NgxWebsocketService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] },
    ];
    /** @nocollapse */
    NgxWebsocketService.ctorParameters = function () { return []; };
    /** @nocollapse */ NgxWebsocketService.ngInjectableDef = defineInjectable({ factory: function NgxWebsocketService_Factory() { return new NgxWebsocketService(); }, token: NgxWebsocketService, providedIn: "root" });
    return NgxWebsocketService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var NgxWebsocketComponent = /** @class */ (function () {
    function NgxWebsocketComponent(websocketService) {
        this.websocketService = websocketService;
    }
    NgxWebsocketComponent.decorators = [
        { type: Component, args: [{
                    selector: 'enl-ngx-websocket',
                    template: "\n    <p>\n      ngx-websocket works!\n    </p>\n    <div>\n      <button>\u53D1\u9001</button>\n    </div>\n  ",
                    styles: []
                },] },
    ];
    /** @nocollapse */
    NgxWebsocketComponent.ctorParameters = function () { return [
        { type: NgxWebsocketService }
    ]; };
    return NgxWebsocketComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var NgxWebsocketModule = /** @class */ (function () {
    function NgxWebsocketModule() {
    }
    NgxWebsocketModule.decorators = [
        { type: NgModule, args: [{
                    imports: [],
                    declarations: [NgxWebsocketComponent],
                    exports: [NgxWebsocketComponent]
                },] },
    ];
    return NgxWebsocketModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

export { NgxWebsocketService, NgxWebsocketComponent, NgxWebsocketModule, Socket };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXdlYnNvY2tldC5qcy5tYXAiLCJzb3VyY2VzIjpbIm5nOi8vbmd4LXdlYnNvY2tldC9saWIvc3Vic2NyaWJlLnRzIiwibmc6Ly9uZ3gtd2Vic29ja2V0L2xpYi9zb2NrZXQudHMiLCJuZzovL25neC13ZWJzb2NrZXQvbGliL25neC13ZWJzb2NrZXQuc2VydmljZS50cyIsIm5nOi8vbmd4LXdlYnNvY2tldC9saWIvbmd4LXdlYnNvY2tldC5jb21wb25lbnQudHMiLCJuZzovL25neC13ZWJzb2NrZXQvbGliL25neC13ZWJzb2NrZXQubW9kdWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBTdWJzY3JpYmUge1xuICAgIHB1YmxpYyB0eXBlOiBudW1iZXI7IC8vdGhlbjogMCwgbWVzc2FnZTogMSwgY2F0Y2g6IDIsIGZpbmFsbHk6IDMuXG4gICAgcHVibGljIGY6IEZ1bmN0aW9uO1xuICAgIGNvbnN0cnVjdG9yKF90eXBlOiBudW1iZXIsIF9mOiBGdW5jdGlvbikge1xuICAgICAgICB0aGlzLnR5cGUgPSBfdHlwZTtcbiAgICAgICAgdGhpcy5mID0gX2Y7XG4gICAgfVxufSIsImltcG9ydCB7IE9ic2VydmFibGUsIFN1YnNjcmlwdGlvbiB9IGZyb20gXCJyeGpzXCI7XG5pbXBvcnQgeyBVdGlscyB9IGZyb20gXCIuL3V0aWxzXCI7XG5pbXBvcnQgeyBTdWJzY3JpYmUgfSBmcm9tIFwiLi9zdWJzY3JpYmVcIjtcbi8qKlxuICogU29ja2V0IGNsYXNzXG4gKiBlYWNoIHNvY2tldCBoYW5kbGVzIGEgc2luZ2xlIFdlYlNjb2tldCBDb25uZWN0aW9uLlxuICovXG5leHBvcnQgY2xhc3MgU29ja2V0IHtcbiAgICBwcml2YXRlIHdlYnNvY2tldDogV2ViU29ja2V0O1xuICAgIHByaXZhdGUgX3N0YXRlOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBfcGFzc2luZ0RhdGE6IGFueTtcbiAgICBwcml2YXRlIF9yZWNlaXZlRGF0YTogYW55O1xuICAgIHByaXZhdGUgX29wZW5PYnNlcnZhYmxlOiBPYnNlcnZhYmxlPGFueT47XG4gICAgcHJpdmF0ZSBfZXJyb3JPYnNlcnZhYmxlOiBPYnNlcnZhYmxlPGFueT47XG4gICAgcHJpdmF0ZSBfbWVzc2FnZU9ic2VydmFibGU6IE9ic2VydmFibGU8YW55PjtcbiAgICBwcml2YXRlIF9jbG9zZU9ic2VydmFibGU6IE9ic2VydmFibGU8YW55PjtcbiAgICBwcml2YXRlIF9zdWJzY3JpYmVzOiBTdWJzY3JpYmVbXTtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdXJsOiBzdHJpbmcpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMud2Vic29ja2V0ID0gbmV3IFdlYlNvY2tldCh1cmwpO1xuICAgICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3N0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgdGhpcy5fc3Vic2NyaWJlcyA9IFtdO1xuICAgICAgICAvL29uT3BlblxuICAgICAgICB0aGlzLndlYnNvY2tldC5hZGRFdmVudExpc3RlbmVyKFwib3BlblwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgLy93ZWJzb2NrZXQgc3RyZWFtIHN0YXJ0XG4gICAgICAgICAgICB0aGlzLnN1YnNjcmliZUxvb3AodHJ1ZSk7XG4gICAgICAgIH0pXG5cbiAgICAgICAgLy9vbkVycm9yXG4gICAgICAgIHRoaXMud2Vic29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIndlYnNvY2tldCBvbkVycm9yXCIpO1xuICAgICAgICB9KVxuXG4gICAgICAgIC8vb25NZXNzYWdlXG4gICAgICAgIC8vIHRoaXMuX21lc3NhZ2VPYnNlcnZhYmxlID0gT2JzZXJ2YWJsZS5jcmVhdGUoKG9ic2VydmVyKSA9PiB7XG4gICAgICAgIC8vICAgICB0aGlzLndlYnNvY2tldC5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCAoZSkgPT4ge1xuICAgICAgICAvLyAgICAgICAgIG9ic2VydmVyLm5leHQoe1xuICAgICAgICAvLyAgICAgICAgICAgICBldmVudDogZVxuICAgICAgICAvLyAgICAgICAgIH0pO1xuICAgICAgICAvLyAgICAgICAgIC8vc3RyZWFtIHN0YXJ0IGFnYWluXG4gICAgICAgIC8vICAgICAgICAgdGhpcy5zdWJzY3JpYmVMb29wKGZhbHNlKTtcbiAgICAgICAgLy8gICAgIH0pO1xuICAgICAgICAvLyB9KTtcblxuICAgICAgICAvL29uTWVzc2FnZVxuICAgICAgICB0aGlzLndlYnNvY2tldC5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fcmVjZWl2ZURhdGEgPSBlO1xuICAgICAgICAgICAgLy9zdHJlYW0gc3RhcnQgYWdhaW5cbiAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlTG9vcChmYWxzZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vb25DbG9zZVxuICAgICAgICB0aGlzLndlYnNvY2tldC5hZGRFdmVudExpc3RlbmVyKFwiY2xvc2VcIiwgKGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIndlYnNvY2tldCBvbkNsb3NlXCIpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXZlaXZlIGRhdGEgZnJvbSBwcmV2aW91cyBoYW5kbGVyLCB3b3VsZG4ndCBibG9jayBjdXJyZW50IHN0cmVhbS5cbiAgICAgKiBAcGFyYW0gZiBcbiAgICAgKi9cbiAgICBwdWJsaWMgdGhlbihmOiAoZDogYW55LCBzb2NrZXQ/OiBTb2NrZXQpID0+IGFueSk6IFNvY2tldCB7XG4gICAgICAgIHRoaXMuX3N1YnNjcmliZXMucHVzaChuZXcgU3Vic2NyaWJlKDAsIGYpKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY2FsbGJhY2sgZnVudGlvbiB3aGVuIHdlYnNvY2tldCByZXZlaXZlIG1lc3NhZ2UuIFxuICAgICAqIEBwYXJhbSBmIFxuICAgICAqL1xuICAgIHB1YmxpYyBtZXNzYWdlKGY6ICh0ZXh0OiBhbnksIGQ/OiBhbnksIHNvY2tldD86IFNvY2tldCwgZXZlbnQ/OiBFdmVudCkgPT4gYW55KTogU29ja2V0IHtcbiAgICAgICAgdGhpcy5fc3Vic2NyaWJlcy5wdXNoKG5ldyBTdWJzY3JpYmUoMSwgZikpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjYXRjaCBlcnJvciBvciBjbG9zZSBzdGF0ZSBvbiB3ZWJzb2NrZXQ7XG4gICAgICovXG4gICAgcHVibGljIGNhdGNoKCk6IFNvY2tldCB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGZpbmFsbHkgaGFuZGxlci5cbiAgICAgKi9cbiAgICBwdWJsaWMgZmluYWxseSgpOiBTb2NrZXQge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBzZW5kIG1lc3NhZ2UgdmlhIHRoaXMgd2Vic29ja2V0XG4gICAgICogQHBhcmFtIG1lc3NhZ2UgXG4gICAgICovXG4gICAgcHVibGljIHNlbmQobWVzc2FnZTogc3RyaW5nKTogU29ja2V0IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMud2Vic29ja2V0LnNlbmQobWVzc2FnZSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY2xvc2Ugd2Vic29ja2V0XG4gICAgICovXG4gICAgcHVibGljIGNsb3NlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLndlYnNvY2tldC5jbG9zZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHRyYXZlcnNhbCBzdWJzY2lyYmVzIHNldCwgZXhlY3V0ZSBhY3Rpb24gYWNjb3JkaW5nIHRvIGl0ZW0ncyB0eXBlXG4gICAgICogQHBhcmFtIGluaXQgaWYgc3Vic2NyaWJlTG9vcCBpcyB0aGUgZmlyc3QgdGllbSB0byBleGVjdXRlLCB0aGFuIGV2ZXJ5ICd0aGVuJyBoYW5kbGVyIGJlZm9yZSB0aGUgZmlyc3QgbWVzc2FnZSBoYW5kbGVyIHdpbGwgYmUgcmVtb3ZlIGFmdGVyIGV4ZWN1dGUuXG4gICAgICovXG4gICAgcHVibGljIHN1YnNjcmliZUxvb3AoaW5pdDogYm9vbGVhbik6IHZvaWQge1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gdGhpcy5fc3Vic2NyaWJlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgbGV0IHN1YiA9IHRoaXMuX3N1YnNjcmliZXNbaV07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChzdWIudHlwZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Bhc3NpbmdEYXRhID0gc3ViLmYodGhpcy5fcGFzc2luZ0RhdGEsIHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmIChpbml0ID09PSB0cnVlKSB0aGlzLl9zdWJzY3JpYmVzW2ldID0gbmV3IFN1YnNjcmliZSgwLCAoKSA9PiB7fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3ViLnR5cGUgPT09IDEpIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5pdCA9PT0gdHJ1ZSkgYnJlYWs7XG4gICAgICAgICAgICAgICAgLy8gdGhpcy5fbWVzc2FnZU9ic2VydmFibGUuc3Vic2NyaWJlKHtcbiAgICAgICAgICAgICAgICAvLyAgICAgbmV4dChkKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBzb2NrZXQuX3Bhc3NpbmdEYXRhID0gc3ViLmYoKGQuZXZlbnQuZGF0YSksIHNvY2tldC5fcGFzc2luZ0RhdGEsIHNvY2tldCwgZC5ldmVudCk7XG4gICAgICAgICAgICAgICAgLy8gICAgIH0sXG4gICAgICAgICAgICAgICAgLy8gICAgIGVycm9yKG1zZykge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgLy9jYWxsIHRoZSBjYXRjaCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgICAgICAvLyB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9wYXNzaW5nRGF0YSA9IHN1Yi5mKHRoaXMuX3JlY2VpdmVEYXRhLmRhdGEsIHRoaXMuX3Bhc3NpbmdEYXRhLCB0aGlzLCB0aGlzLl9yZWNlaXZlRGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL2dldCBzdGF0ZSBwcm9wZXJ0eVxuICAgIHB1YmxpYyBnZXQgc3RhdGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdGF0ZTtcbiAgICB9XG5cblxuXG59IiwiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgU29ja2V0IH0gZnJvbSAnLi9zb2NrZXQnO1xuXG4vKipcbiAqIHRoaXMgc2VydmljZSBwcm92aWRlcyBtdWx0aXBsZSBtZXRob2RzIHRvIGNyZWF0ZSB3ZWJzb2NrZXQsIGFkZCBjYWxsYmFjayBmdW5jdGlvbiB0byB3ZWJzb2Nla3Qgb3IgZGVzdG9yeSB3ZWJzY29rZXQuXG4gKi9cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIE5neFdlYnNvY2tldFNlcnZpY2Uge1xuICAvL3NhdmUgYWxsIHRoZSBzb2NrZXQgb3BlbmVkIGJ5IHRoaXMgc2VydmljZVxuICBwcml2YXRlIHNvY2tldHM6IE1hcDxzdHJpbmcsIFNvY2tldD47XG4gIFxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnNvY2tldHMgPSBuZXcgTWFwPHN0cmluZywgU29ja2V0PigpO1xuICB9XG5cbiAgcHVibGljIG9wZW4odXJsKTogU29ja2V0IHtcbiAgICBpZiAoIXRoaXMuY2hlY2tFeGlzdGVuY2UodXJsKSkge1xuICAgICAgbGV0IHNvY2tldCA9IG5ldyBTb2NrZXQodXJsKTtcbiAgICAgIHRoaXMuc29ja2V0cy5zZXQodXJsLCBzb2NrZXQpO1xuICAgICAgcmV0dXJuIHNvY2tldDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGNoZWNrRXhpc3RlbmNlKHVybCkge1xuICAgIHRoaXMuc29ja2V0cy5mb3JFYWNoKChrZXksIHZhbHVlKSA9PiB7XG4gICAgICBpZiAoa2V5ID09PSB1cmwpIHtcbiAgICAgICAgLy9jaGVjayBjb25uZWN0aW9uIHN0YXRlXG4gICAgICAgIGNvbnNvbGUud2FybihcImEgd2Vic29ja2V0IHdpdGggc2FtZSB1cmwgaGFzIGV4aXN0ZWRcIik7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG4iLCJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgTmd4V2Vic29ja2V0U2VydmljZSB9IGZyb20gJy4vbmd4LXdlYnNvY2tldC5zZXJ2aWNlJztcbmltcG9ydCB7IFNvY2tldCB9IGZyb20gJy4vc29ja2V0JztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnZW5sLW5neC13ZWJzb2NrZXQnLFxuICB0ZW1wbGF0ZTogYFxuICAgIDxwPlxuICAgICAgbmd4LXdlYnNvY2tldCB3b3JrcyFcbiAgICA8L3A+XG4gICAgPGRpdj5cbiAgICAgIDxidXR0b24+w6XCj8KRw6nCgMKBPC9idXR0b24+XG4gICAgPC9kaXY+XG4gIGAsXG4gIHN0eWxlczogW11cbn0pXG5leHBvcnQgY2xhc3MgTmd4V2Vic29ja2V0Q29tcG9uZW50IHtcbiAgc29ja2V0OiBTb2NrZXQ7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgd2Vic29ja2V0U2VydmljZTogTmd4V2Vic29ja2V0U2VydmljZSxcbiAgICApIHtcbiAgICAgIFxuICAgICB9XG5cblxuXG5cbn1cbiIsImltcG9ydCB7IE5nTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBOZ3hXZWJzb2NrZXRDb21wb25lbnQgfSBmcm9tICcuL25neC13ZWJzb2NrZXQuY29tcG9uZW50JztcblxuQE5nTW9kdWxlKHtcbiAgaW1wb3J0czogW1xuICBdLFxuICBkZWNsYXJhdGlvbnM6IFtOZ3hXZWJzb2NrZXRDb21wb25lbnRdLFxuICBleHBvcnRzOiBbTmd4V2Vic29ja2V0Q29tcG9uZW50XVxufSlcbmV4cG9ydCBjbGFzcyBOZ3hXZWJzb2NrZXRNb2R1bGUgeyB9XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQTtJQUdJLG1CQUFZLEtBQWEsRUFBRSxFQUFZO1FBQ25DLElBQUksQ0FBQyxJQUFJLEdBQUcsS0FBSyxDQUFDO1FBQ2xCLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDO0tBQ2Y7b0JBTkw7SUFPQyxDQUFBOzs7Ozs7QUNMRDs7OztBQUtBOzs7O0FBQUE7SUFXSSxnQkFBb0IsR0FBVztRQUEvQixpQkEwQ0M7UUExQ21CLFFBQUcsR0FBSCxHQUFHLENBQVE7UUFDM0IsSUFBSTtZQUNBLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUM7U0FDdkM7UUFBQyx3QkFBTSxDQUFDLEVBQUU7WUFDTixPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ3JCO1FBQ0QsSUFBSSxDQUFDLE1BQU0sR0FBRyxRQUFRLENBQUM7UUFDdkIsSUFBSSxDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUM7O1FBRXRCLElBQUksQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxFQUFFLFVBQUMsQ0FBQzs7O1lBRXRDLEtBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDNUIsQ0FBQyxDQUFBOztRQUdGLElB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